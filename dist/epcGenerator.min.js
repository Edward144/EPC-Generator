function epcCalculate(n){var c=[],s=n.find(".current .chartPointer"),a=n.find(".potential .chartPointer"),r=0;n.find(".overall .epcBar").each(function(){c[r]=$(this).css("background-color"),r++});var e,i,d=parseInt(s.text()),o=parseInt(a.text()),t=0,v=0;d>=92?(s.css("background",c[0]),t=100):d>=81?(s.css("background",c[1]),t=91):d>=69?(s.css("background",c[2]),t=80):d>=55?(s.css("background",c[3]),t=68):d>=39?(s.css("background",c[4]),t=54):d>=21?(s.css("background",c[5]),t=38):(s.css("background",c[6]),t=20),o>=92?(a.css("background",c[0]),v=100):o>=81?(a.css("background",c[1]),v=91):o>=69?(a.css("background",c[2]),v=80):o>=55?(a.css("background",c[3]),v=68):o>=39?(a.css("background",c[4]),v=54):o>=21?(a.css("background",c[5]),v=38):(a.css("background",c[6]),v=20);var l=$.inArray(s.css("background-color"),c),p=$.inArray(a.css("background-color"),c);e=d*((29*(c.length-l)-d)/t+1),i=o*((29*(c.length-p)-o)/v+1),s.css({"margin-bottom":e}),a.css({"margin-bottom":i})}function epcGenerate(n,c=0,s=0,a="epc"){a="eir"==a?"eir":"epc",c<0?c=0:c>100&&(c=100),s<0?s=0:s>100&&(s=100),n.addClass("epcGraph "+a),n.html('<div class="overall">\n            <span>Very energy efficient - '+("epc"==a?"lower running costs":"lower CO<sub>2</sub> emissions")+'</span>\n\n            <div class="epcBar epcA"></div>\n\n            <div class="epcBar epcB"></div>\n\n            <div class="epcBar epcC"></div>\n\n            <div class="epcBar epcD"></div>\n\n            <div class="epcBar epcE"></div>\n\n            <div class="epcBar epcF"></div>\n\n            <div class="epcBar epcG"></div>\n\n            <span>Not energy efficient - '+("epc"==a?"higher running costs":"higher CO<sub>2</sub> emissions")+'</span>\n        </div>\n\n        <div class="current">\n            <div class="header">\n              Current\n            </div>\n\n            <div class="chart">\n              <div class="chartPointer">'+c+'</div>\n            </div>\n        </div>\n\n        <div class="potential">\n            <div class="header">\n              Potential\n            </div>\n\n            <div class="chart">\n              <div class="chartPointer">'+s+"</div>\n            </div>\n        </div>"),epcCalculate(n)}